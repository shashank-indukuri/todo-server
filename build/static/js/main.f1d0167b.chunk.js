(this.webpackJsonptodo=this.webpackJsonptodo||[]).push([[0],{101:function(e,t,a){"use strict";a.r(t);var c=a(0),n=a.n(c),s=a(23),r=a.n(s),o=a(9),i=a(37),d=a.n(i),j=a(6),u=a(12),l=a(10),b=a(105),O=a(31);function h(e,t){switch(t.type){case"LOGIN":case"REGISTER":return{id:t.id,username:t.username,access_token:t.access_token};case"LOGOUT":return{id:"",username:"",access_token:""};default:return e}}function x(e,t){return"FETCH_USERS"===t.type?t.users:e}function f(e,t){switch(t.type){case"CREATE_TODO":return 0===e.filter((function(e){return e.id===t.newTodo.id})).length?[t.newTodo].concat(Object(O.a)(e)):e;case"TOGGLE_TODO":return e.map((function(e){var a=e;return e.id===t.id&&(a.complete=t.complete,a.dateCompleted=t.dateCompleted),a}));case"DELETE_TODO":var a=e.filter((function(e){return e.id!==t.id}));return Object(O.a)(a);case"FETCH_TODOS":return t.todos;default:return e}}function p(e,t){switch(t.type){case"CREATE_TODOLIST":return 0===e.filter((function(e){return e.id===t.newTodoList.id})).length?[t.newTodoList].concat(Object(O.a)(e)):e;case"DELETE_TODOLIST":var a=e.filter((function(e){return e.id!==t.id}));return Object(O.a)(a);case"FETCH_TODOLISTS":return t.todoLists;default:return e}}function m(e,t){return{user:h(e.user,t),todos:f(e.todos,t),users:x(e.users,t),todoLists:p(e.todoLists,t)}}var v=a(7),g=a(109),C=a(107),L=a(104),T=a(110),w=a(108),E=(a(60),a(1));var y=function(e){var t=e.show,a=e.handleClose,n=Object(c.useContext)(v.a).dispatch,s=Object(c.useState)(""),r=Object(j.a)(s,2),i=r[0],d=r[1],u=Object(c.useState)(""),l=Object(j.a)(u,2),b=l[0],O=l[1],h=Object(c.useState)(!1),x=Object(j.a)(h,2),f=x[0],p=x[1],m=Object(o.b)((function(){return{url:"auth/login",method:"post",data:{username:i,password:b}}})),g=Object(j.a)(m,2),C=g[0],y=g[1];return Object(c.useEffect)((function(){C&&!1===C.isLoading&&(C.data||C.error)&&(C.error?p(!0):(p(!1),n({type:"LOGIN",id:C.data.id,username:i,access_token:C.data.access_token}),a()))}),[C]),Object(E.jsx)(E.Fragment,{children:Object(E.jsx)(T.a,{show:t,onHide:a,children:Object(E.jsxs)(w.a,{onSubmit:function(e){e.preventDefault(),y(i,b)},children:[Object(E.jsx)(T.a.Header,{closeButton:!0,children:Object(E.jsx)(T.a.Title,{children:"Login"})}),Object(E.jsxs)(T.a.Body,{children:[Object(E.jsx)(w.a.Label,{htmlFor:"login-username",children:"Username:"}),Object(E.jsx)(w.a.Control,{type:"text",value:i,onChange:function(e){d(e.target.value)},name:"login-username",id:"login-username"}),Object(E.jsx)(w.a.Label,{htmlFor:"login-password",children:"Password:"}),Object(E.jsx)(w.a.Control,{type:"password",value:b,onChange:function(e){O(e.target.value)},name:"login-password",id:"login-password"}),f&&Object(E.jsx)(w.a.Text,{style:{color:"red"},children:"Invalid username or password"})]}),Object(E.jsxs)(T.a.Footer,{children:[Object(E.jsx)(L.a,{variant:"secondary",onClick:a,children:"Cancel"}),Object(E.jsx)(L.a,{variant:"primary",disabled:0===i.length,type:"submit",children:"Login"})]})]})})})},S=a(2);var k=function(e){var t=e.show,a=e.handleClose,n=Object(c.useContext)(v.a).dispatch,s=Object(c.useState)({username:"",password:"",confirmPassword:""}),r=Object(j.a)(s,2),i=r[0],d=r[1],u=Object(c.useState)(""),l=Object(j.a)(u,2),b=l[0],O=l[1],h=Object(c.useState)(!1),x=Object(j.a)(h,2),f=x[0],p=x[1],m=Object(o.b)((function(e,t,a){return{url:"/auth/register",method:"post",data:{username:e,password:t,passwordConfirmation:a}}})),g=Object(j.a)(m,2),C=g[0],y=g[1];return Object(c.useEffect)((function(){C&&C.data&&n({type:"REGISTER",id:C.data.id,username:C.data.username,access_token:C.data.access_token})}),[C]),Object(c.useEffect)((function(){C&&!1===C.isLoading&&(C.data||C.error)&&(C.error?(O("Registration failed, please try again later."),p(!0)):(p(!1),a()))}),[C]),Object(E.jsx)(T.a,{show:t,onHide:a,children:Object(E.jsxs)(w.a,{onSubmit:function(e){e.preventDefault(),y(i.username,i.password,i.confirmPassword)},children:[Object(E.jsx)(T.a.Header,{closeButton:!0,children:Object(E.jsx)(T.a.Title,{children:"Register"})}),Object(E.jsxs)(T.a.Body,{children:[Object(E.jsx)(w.a.Label,{htmlFor:"register-username",children:"Username:"}),Object(E.jsx)(w.a.Control,{type:"text",value:i.username,onChange:function(e){d(Object(S.a)(Object(S.a)({},i),{},{username:e.target.value}))},name:"register-username",id:"register-username"}),Object(E.jsx)(w.a.Label,{htmlFor:"register-password",children:"Password:"}),Object(E.jsx)(w.a.Control,{type:"password",name:"register-password",id:"register-password",value:i.password,onChange:function(e){d(Object(S.a)(Object(S.a)({},i),{},{password:e.target.value}))}}),Object(E.jsx)(w.a.Label,{htmlFor:"register-password-repeat",children:"Repeat password:"}),Object(E.jsx)(w.a.Control,{type:"password",name:"register-password-repeat",id:"register-password-repeat",value:i.passwordRepeat,onChange:function(e){d(Object(S.a)(Object(S.a)({},i),{},{confirmPassword:e.target.value}))}}),f&&Object(E.jsx)(w.a.Text,{style:{color:"red"},children:b})]}),Object(E.jsxs)(T.a.Footer,{children:[Object(E.jsx)(L.a,{variant:"secondary",onClick:a,children:"Cancel"}),Object(E.jsx)(L.a,{variant:"primary",type:"submit",disabled:0===i.username.length||0===i.password.length||i.password!==i.confirmPassword,children:"Register"})]})]})})};var D=function(){var e=n.a.lazy((function(){return a.e(3).then(a.bind(null,112))})),t=Object(c.useContext)(v.a).state,s=Object(c.useState)(!1),r=Object(j.a)(s,2),o=r[0],i=r[1],d=Object(c.useState)(!1),u=Object(j.a)(d,2),l=u[0],b=u[1];return t.user.username?Object(E.jsx)(e,{}):Object(E.jsxs)("div",{className:"justify-content-end",children:[Object(E.jsx)(L.a,{variant:"link",onClick:function(){return i(!0)},children:"Login"}),Object(E.jsx)(y,{show:o,handleClose:function(){return i(!1)}}),Object(E.jsx)(L.a,{variant:"link",onClick:function(){return b(!0)},children:"Register"}),Object(E.jsx)(k,{show:l,handleClose:function(){return b(!1)}})]})},_=function(e){var t=e.text;return Object(E.jsx)(l.a,{href:"/",children:Object(E.jsx)(g.a.Brand,{children:t})})};function F(){var e=Object(c.useContext)(v.a).state.user;return Object(E.jsx)(g.a,{bg:"light",expand:"lg",children:Object(E.jsxs)(b.a,{children:[Object(E.jsx)(g.a.Brand,{href:"/",children:Object(E.jsx)(_,{text:"To-Do"})}),Object(E.jsx)(g.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(E.jsxs)(g.a.Collapse,{id:"basic-navbar-nav",children:[Object(E.jsxs)(C.a,{className:"me-auto",children:[Object(E.jsx)(C.a.Link,{children:Object(E.jsx)(l.a,{href:"/users",children:"Users"})}),e.username&&Object(E.jsx)(C.a.Link,{children:Object(E.jsx)(l.a,{href:"/todoLists/create",children:"Create New TodoList"})})]}),Object(E.jsx)(n.a.Suspense,{fallback:"Loading...",children:Object(E.jsx)(D,{})})]})]})})}var I=a(106),R=a(111);var U=function(e){var t=e.id,a=e.title,n=e.description,s=Object(c.useContext)(v.a),r=s.state,i=s.dispatch,d=r.user,u=Object(c.useState)(!1),b=Object(j.a)(u,2),O=b[0],h=b[1],x=Object(o.b)((function(e){return{url:"/todoLists",method:"delete",data:{id:e,author:d.id},headers:{Authorization:"".concat(d.access_token)}}})),f=Object(j.a)(x,2),p=f[0],m=f[1];return Object(c.useEffect)((function(){p&&(p.data||p.error)&&!1===p.isLoading&&(p.error?h(!0):(h(!1),i({type:"DELETE_TODOLIST",id:p.data.id})))}),[p]),Object(E.jsx)(R.a,{children:Object(E.jsxs)(R.a.Body,{children:[Object(E.jsx)(R.a.Title,{children:Object(E.jsx)(l.a,{href:"/todoLists/".concat(t),children:a})}),Object(E.jsx)(R.a.Text,{children:n}),Object(E.jsx)(L.a,{variant:"link",onClick:function(){m(t)},children:"Delete TodoList"}),O&&Object(E.jsx)(R.a.Text,{style:{color:"red"},children:"Unauthorized, Please Login..."})]})})};var A=function(){var e=Object(c.useContext)(v.a).state.todoLists;return Object(E.jsxs)("div",{children:[e.length>0&&Object(E.jsx)("h5",{children:"Todo Lists"}),e.map((function(e){return Object(E.jsx)(U,Object(S.a)({},e),e.id)}))]})};function G(){var e=Object(c.useContext)(v.a),t=e.state,a=e.dispatch,n=t.user,s=Object(o.b)((function(){return{url:"todoLists",method:"get",headers:{Authorization:"".concat(n.access_token)}}})),r=Object(j.a)(s,2),i=r[0],d=r[1];Object(c.useEffect)((function(){n.id&&d()}),[n.access_token]),Object(c.useEffect)((function(){i&&i.data&&a({type:"FETCH_TODOLISTS",todoLists:i.data.todoLists})}),[i]);var u=i.isLoading;return Object(E.jsxs)(E.Fragment,{children:[u&&Object(E.jsx)(I.a,{animation:"border",role:"status",children:Object(E.jsx)("span",{className:"todoListsvisually-hidden",children:"TodoLists Loading..."})}),Object(E.jsx)(A,{})]})}var H=function(e){var t=e.todoListId,a=Object(c.useContext)(v.a),n=a.state,s=a.dispatch,r=n.user,i=Object(c.useState)(""),d=Object(j.a)(i,2),u=d[0],b=d[1],O=Object(c.useState)(""),h=Object(j.a)(O,2),x=h[0],f=h[1],p=Object(l.d)(),m=Object(o.b)((function(e){var a=e.title,c=e.description,n=e.dateCreated,s=e.complete,o=e.dateCompleted;return{url:"/todos",method:"post",headers:{Authorization:"".concat(r.access_token)},data:{title:a,description:c,dateCreated:n,complete:s,dateCompleted:o,author:r.id,todoList:t}}})),g=Object(j.a)(m,2),C=g[0],L=g[1];return Object(c.useEffect)((function(){if(C&&C.data&&!1===C.isLoading){var e={id:C.data.id,title:C.data.title,description:C.data.description,dateCreated:C.data.dateCreated,complete:C.data.complete,dateCompleted:C.data.dateCompleted,author:C.data.author,todoList:C.data.todoList};s({type:"CREATE_TODO",newTodo:e}),p.navigate("/todo/".concat(C.data.id))}}),[C]),Object(E.jsxs)("form",{onSubmit:function(e){e.preventDefault(),L({title:u,description:x,dateCreated:Date.now(),complete:!1,dateCompleted:null}),b(""),f("")},children:[Object(E.jsxs)("div",{children:[Object(E.jsx)("label",{htmlFor:"create-title",children:"Title:"}),Object(E.jsx)("input",{type:"text",id:"create-title",value:u,onChange:function(e){b(e.target.value)},name:"create-title"})]}),Object(E.jsx)("br",{}),Object(E.jsx)("textarea",{value:x,onChange:function(e){f(e.target.value)},placeholder:"Description"}),Object(E.jsx)("br",{}),Object(E.jsx)("input",{type:"submit",value:"Create",disabled:0===u.length})]})};var z=function(e){var t=e.id,a=e.title,n=e.description,s=e.dateCreated,r=e.complete,i=e.dateCompleted,d=e.author,u=e.short,b=void 0!==u&&u,O=e.disable,h=void 0!==O&&O,x=Object(c.useContext)(v.a),f=x.state,p=x.dispatch,m=f.user,g=Object(c.useState)(!1),C=Object(j.a)(g,2),T=C[0],w=C[1],y=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}),S=Object(o.b)((function(e){return{url:"/todos",method:"delete",data:{id:e,author:d},headers:{Authorization:"".concat(m.access_token)}}})),k=Object(j.a)(S,2),D=k[0],_=k[1],F=Object(o.b)((function(e){var a=e.complete,c=e.dateCompleted;return{url:"/todos",method:"patch",data:{id:t,complete:a,dateCompleted:c,author:d},headers:{Authorization:"".concat(m.access_token)}}})),I=Object(j.a)(F,2),U=I[0],A=I[1];Object(c.useEffect)((function(){D&&(D.data||D.error)&&!1===D.isLoading&&(D.error?w(!0):(w(!1),p({type:"DELETE_TODO",id:D.data.id})))}),[D]),Object(c.useEffect)((function(){U&&(U.data||U.error)&&!1===U.isLoading&&(U.error?w(!0):(w(!1),p({type:"TOGGLE_TODO",complete:U.data.complete,dateCompleted:U.data.dateCompleted,id:t})))}),[U]);var G=n;return b&&n.length>30&&(G="".concat(n.substring(0,30)," ...")),Object(E.jsx)(R.a,{children:Object(E.jsxs)(R.a.Body,{children:[Object(E.jsx)(R.a.Title,{children:Object(E.jsx)(l.a,{href:"/todo/".concat(t),children:a})}),Object(E.jsx)(R.a.Subtitle,{children:Object(E.jsxs)("i",{children:["Written by ",Object(E.jsx)("b",{children:m.username})]})}),Object(E.jsx)(R.a.Text,{children:G}),Object(E.jsx)("input",{type:"checkbox",checked:r,onChange:function(e){var t=null;t=e.target.checked?Date.now():null,A({complete:e.target.checked,dateCompleted:t})}}),Object(E.jsx)(L.a,{variant:"link",disabled:h,onClick:function(){_(t)},children:"Delete Todo"}),Object(E.jsxs)(R.a.Text,{children:["Created on: ",y.format(s)]}),i&&Object(E.jsxs)("i",{children:["Completed on: ",y.format(i)]}),Object(E.jsx)("br",{}),b&&Object(E.jsx)(l.a,{href:"/todo/".concat(t),children:"View full post"}),T&&Object(E.jsx)(R.a.Text,{style:{color:"red"},children:"Unauthorized, Please Login..."})]})})};function B(e){var t=e.id,a=Object(c.useContext)(v.a).state.todos,n=Object(o.b)((function(){return{url:"/todos/".concat(t),method:"get"}})),s=Object(j.a)(n,2),r=s[0],i=s[1];return Object(c.useEffect)(i,[a]),Object(E.jsxs)("div",{children:[Object(E.jsx)("div",{children:Object(E.jsx)(l.a,{href:"/",children:"Go back"})}),r&&r.data?Object(E.jsx)(z,Object(S.a)(Object(S.a)({},r.data),{},{disable:!0})):"Loading..."]})}var N=function(e){var t=e.id,a=e.username;return Object(E.jsx)(R.a,{children:Object(E.jsx)(R.a.Body,{children:Object(E.jsx)(R.a.Title,{children:Object(E.jsx)(l.a,{href:"/users/".concat(t),children:a})})})})};var P=function(){var e=Object(c.useContext)(v.a).state.users;return Object(E.jsxs)("div",{children:[e.length>0&&Object(E.jsx)("h5",{children:"Users List"}),e.map((function(e){return Object(E.jsx)(N,Object(S.a)({},e),e.id)}))]})};function J(){var e=Object(c.useContext)(v.a).dispatch,t=Object(o.b)((function(){return{url:"/users",method:"get"}})),a=Object(j.a)(t,2),n=a[0],s=a[1];Object(c.useEffect)(s,[]),Object(c.useEffect)((function(){n&&n.data&&e({type:"FETCH_USERS",users:n.data.users})}),[n]);var r=n.isLoading;return Object(E.jsxs)(E.Fragment,{children:[r&&Object(E.jsx)(I.a,{animation:"border",role:"status",children:Object(E.jsx)("span",{className:"visually-hidden",children:"Users Loading..."})}),Object(E.jsx)(P,{})]})}var M=function(){var e=Object(c.useContext)(v.a).state.todos;return Object(E.jsxs)("div",{children:[e.length>0&&Object(E.jsx)("h5",{children:"Todos"}),0===e.length&&Object(E.jsx)("i",{children:"No todos to display. Create a new one..."}),e.map((function(e){return Object(E.jsx)(z,Object(S.a)(Object(S.a)({},e),{},{short:true}),e.id)}))]})};function V(e){var t=e.id,a=Object(c.useContext)(v.a).dispatch,n=Object(o.b)((function(){return{url:"/users/".concat(t),method:"get"}})),s=Object(j.a)(n,2),r=s[0],i=s[1];Object(c.useEffect)(i,[]),Object(c.useEffect)((function(){r&&!1===r.isLoading&&r.data&&a({type:"FETCH_TODOS",todos:r.data.todos})}),[r]);var d=r.isLoading;return Object(E.jsxs)("div",{children:[Object(E.jsx)("hr",{}),Object(E.jsxs)("div",{children:[Object(E.jsx)(l.a,{href:"/users",children:"Go back"}),d&&"Todos loading..."," ",Object(E.jsx)(M,{})]})]})}function W(e){var t=e.id,a=Object(c.useContext)(v.a),n=a.state,s=a.dispatch,r=n.user,i="/todoList/".concat(t,"/todo/create"),d=Object(o.b)((function(){return{url:"/todoLists/".concat(t),method:"get",headers:{Authorization:"".concat(r.access_token)}}})),u=Object(j.a)(d,2),b=u[0],O=u[1];Object(c.useEffect)((function(){r.id&&O()}),[r.access_token]),Object(c.useEffect)((function(){b&&b.data&&s({type:"FETCH_TODOS",todos:b.data.todos})}),[b]);var h=b.isLoading;return Object(E.jsxs)(E.Fragment,{children:[h&&Object(E.jsx)(I.a,{animation:"border",role:"status",children:Object(E.jsx)("span",{className:"visually-hidden",children:"Todos Loading..."})}),r.username&&Object(E.jsx)(l.a,{href:i,children:"Create New Todo"}),Object(E.jsx)(M,{})]})}var q=function(){var e=Object(c.useContext)(v.a),t=e.state,a=e.dispatch,n=t.user,s=Object(c.useState)(""),r=Object(j.a)(s,2),i=r[0],d=r[1],u=Object(c.useState)(""),b=Object(j.a)(u,2),O=b[0],h=b[1],x=Object(l.d)(),f=Object(o.b)((function(e){var t=e.title,a=e.description;return{url:"/todoLists",method:"post",headers:{Authorization:"".concat(n.access_token)},data:{title:t,description:a,author:n.id}}})),p=Object(j.a)(f,2),m=p[0],g=p[1];return Object(c.useEffect)((function(){if(m&&m.data&&!1===m.isLoading){var e={id:m.data.id,title:m.data.title,description:m.data.description,author:m.data.author};a({type:"CREATE_TODO",newTodo:e}),x.navigate("/todoLists/".concat(m.data.id))}}),[m]),Object(E.jsxs)("form",{onSubmit:function(e){e.preventDefault(),g({title:i,description:O}),d(""),h("")},children:[Object(E.jsxs)("div",{children:[Object(E.jsx)("label",{htmlFor:"create-title",children:"Title:"}),Object(E.jsx)("input",{type:"text",id:"create-title",value:i,onChange:function(e){d(e.target.value)},name:"create-title"})]}),Object(E.jsx)("br",{}),Object(E.jsx)("textarea",{value:O,onChange:function(e){h(e.target.value)},placeholder:"Description"}),Object(E.jsx)("br",{}),Object(E.jsx)("input",{type:"submit",value:"Create",disabled:0===i.length})]})};var K=function(){var e=Object(c.useReducer)(m,{user:{},todos:[],users:[],todoLists:[]}),t=Object(j.a)(e,2),a=t[0],n=t[1],s=a.user,r=Object(u.f)({"/":Object(u.g)({view:Object(E.jsx)(G,{})}),"/users":Object(u.g)({view:Object(E.jsx)(J,{})}),"/users/:userId":Object(u.g)((function(e){return{view:Object(E.jsx)(V,{id:e.params.userId})}})),"/todoList/:todoListId/todo/create":Object(u.g)((function(e){return{view:Object(E.jsx)(H,{todoListId:e.params.todoListId})}})),"/todo/:id":Object(u.g)((function(e){return{view:Object(E.jsx)(B,{id:e.params.id})}})),"/todoLists/:todoListId":Object(u.g)((function(e){return{view:Object(E.jsx)(W,{id:e.params.todoListId})}})),"/todoLists/create":Object(u.g)({view:Object(E.jsx)(q,{})})});return Object(c.useEffect)((function(){s.username?document.title="".concat(s.username,"\u2019s To-Do"):document.title="To-Do"}),[s]),Object(E.jsx)("div",{children:Object(E.jsx)(v.a.Provider,{value:{state:a,dispatch:n},children:Object(E.jsx)(l.b,{routes:r,children:Object(E.jsxs)(b.a,{children:[Object(E.jsx)(F,{}),Object(E.jsx)("hr",{}),Object(E.jsx)(l.c,{})]})})})})},Q=d.a.create({baseURL:"/"});r.a.render(Object(E.jsx)(n.a.StrictMode,{children:Object(E.jsx)(o.a,{value:Q,children:Object(E.jsx)(K,{})})}),document.getElementById("root"))},60:function(e,t,a){},7:function(e,t,a){"use strict";var c=a(0),n=a.n(c).a.createContext({state:{},dispatch:function(){}});t.a=n}},[[101,1,2]]]);
//# sourceMappingURL=main.f1d0167b.chunk.js.map