(this.webpackJsonptodo=this.webpackJsonptodo||[]).push([[0],{101:function(e,t,a){"use strict";a.r(t);var r=a(0),c=a.n(r),n=a(22),s=a.n(n),o=a(10),i=a(36),d=a.n(i),j=a(6),u=a(12),l=a(11),b=a(105),O=a(41);function h(e,t){switch(t.type){case"LOGIN":case"REGISTER":return{id:t.id,username:t.username,access_token:t.access_token};case"LOGOUT":return{id:"",username:"",access_token:""};default:return e}}function x(e,t){return"FETCH_USERS"===t.type?t.users:e}function f(e,t){switch(t.type){case"CREATE_TODO":return 0===e.filter((function(e){return e.id===t.newTodo.id})).length?[t.newTodo].concat(Object(O.a)(e)):e;case"TOGGLE_TODO":return e.map((function(e){var a=e;return e.id===t.id&&(a.complete=t.complete,a.dateCompleted=t.dateCompleted),a}));case"DELETE_TODO":var a=e.filter((function(e){return e.id!==t.id}));return Object(O.a)(a);case"FETCH_TODOS":return t.todos;default:return e}}function p(e,t){return{user:h(e.user,t),todos:f(e.todos,t),users:x(e.users,t)}}var m=a(8),v=a(109),g=a(107),C=a(104),w=a(110),T=a(108),y=(a(60),a(1));var E=function(e){var t=e.show,a=e.handleClose,c=Object(r.useContext)(m.a).dispatch,n=Object(r.useState)(""),s=Object(j.a)(n,2),i=s[0],d=s[1],u=Object(r.useState)(""),l=Object(j.a)(u,2),b=l[0],O=l[1],h=Object(r.useState)(!1),x=Object(j.a)(h,2),f=x[0],p=x[1],v=Object(o.b)((function(){return{url:"auth/login",method:"post",data:{username:i,password:b}}})),g=Object(j.a)(v,2),E=g[0],L=g[1];return Object(r.useEffect)((function(){E&&!1===E.isLoading&&(E.data||E.error)&&(E.error?p(!0):(p(!1),c({type:"LOGIN",id:E.data.id,username:i,access_token:E.data.access_token}),a()))}),[E]),Object(y.jsx)(y.Fragment,{children:Object(y.jsx)(w.a,{show:t,onHide:a,children:Object(y.jsxs)(T.a,{onSubmit:function(e){e.preventDefault(),L(i,b)},children:[Object(y.jsx)(w.a.Header,{closeButton:!0,children:Object(y.jsx)(w.a.Title,{children:"Login"})}),Object(y.jsxs)(w.a.Body,{children:[Object(y.jsx)(T.a.Label,{htmlFor:"login-username",children:"Username:"}),Object(y.jsx)(T.a.Control,{type:"text",value:i,onChange:function(e){d(e.target.value)},name:"login-username",id:"login-username"}),Object(y.jsx)(T.a.Label,{htmlFor:"login-password",children:"Password:"}),Object(y.jsx)(T.a.Control,{type:"password",value:b,onChange:function(e){O(e.target.value)},name:"login-password",id:"login-password"}),f&&Object(y.jsx)(T.a.Text,{style:{color:"red"},children:"Invalid username or password"})]}),Object(y.jsxs)(w.a.Footer,{children:[Object(y.jsx)(C.a,{variant:"secondary",onClick:a,children:"Cancel"}),Object(y.jsx)(C.a,{variant:"primary",disabled:0===i.length,type:"submit",children:"Login"})]})]})})})},L=a(2);var k=function(e){var t=e.show,a=e.handleClose,c=Object(r.useContext)(m.a).dispatch,n=Object(r.useState)({username:"",password:"",confirmPassword:""}),s=Object(j.a)(n,2),i=s[0],d=s[1],u=Object(r.useState)(""),l=Object(j.a)(u,2),b=l[0],O=l[1],h=Object(r.useState)(!1),x=Object(j.a)(h,2),f=x[0],p=x[1],v=Object(o.b)((function(e,t,a){return{url:"/auth/register",method:"post",data:{username:e,password:t,passwordConfirmation:a}}})),g=Object(j.a)(v,2),E=g[0],k=g[1];return Object(r.useEffect)((function(){E&&E.data&&c({type:"REGISTER",id:E.data.id,username:E.data.username})}),[E]),Object(r.useEffect)((function(){E&&!1===E.isLoading&&(E.data||E.error)&&(E.error?(O("Registration failed, please try again later."),p(!0)):(p(!1),a()))}),[E]),Object(y.jsx)(w.a,{show:t,onHide:a,children:Object(y.jsxs)(T.a,{onSubmit:function(e){e.preventDefault(),k(i.username,i.password,i.confirmPassword)},children:[Object(y.jsx)(w.a.Header,{closeButton:!0,children:Object(y.jsx)(w.a.Title,{children:"Register"})}),Object(y.jsxs)(w.a.Body,{children:[Object(y.jsx)(T.a.Label,{htmlFor:"register-username",children:"Username:"}),Object(y.jsx)(T.a.Control,{type:"text",value:i.username,onChange:function(e){d(Object(L.a)(Object(L.a)({},i),{},{username:e.target.value}))},name:"register-username",id:"register-username"}),Object(y.jsx)(T.a.Label,{htmlFor:"register-password",children:"Password:"}),Object(y.jsx)(T.a.Control,{type:"password",name:"register-password",id:"register-password",value:i.password,onChange:function(e){d(Object(L.a)(Object(L.a)({},i),{},{password:e.target.value}))}}),Object(y.jsx)(T.a.Label,{htmlFor:"register-password-repeat",children:"Repeat password:"}),Object(y.jsx)(T.a.Control,{type:"password",name:"register-password-repeat",id:"register-password-repeat",value:i.passwordRepeat,onChange:function(e){d(Object(L.a)(Object(L.a)({},i),{},{confirmPassword:e.target.value}))}}),f&&Object(y.jsx)(T.a.Text,{style:{color:"red"},children:b})]}),Object(y.jsxs)(w.a.Footer,{children:[Object(y.jsx)(C.a,{variant:"secondary",onClick:a,children:"Cancel"}),Object(y.jsx)(C.a,{variant:"primary",type:"submit",disabled:0===i.username.length||0===i.password.length||i.password!==i.confirmPassword,children:"Register"})]})]})})};var S=function(){var e=c.a.lazy((function(){return a.e(3).then(a.bind(null,112))})),t=Object(r.useContext)(m.a).state,n=Object(r.useState)(!1),s=Object(j.a)(n,2),o=s[0],i=s[1],d=Object(r.useState)(!1),u=Object(j.a)(d,2),l=u[0],b=u[1];return t.user.username?Object(y.jsx)(e,{}):Object(y.jsxs)("div",{className:"justify-content-end",children:[Object(y.jsx)(C.a,{variant:"link",onClick:function(){return i(!0)},children:"Login"}),Object(y.jsx)(E,{show:o,handleClose:function(){return i(!1)}}),Object(y.jsx)(C.a,{variant:"link",onClick:function(){return b(!0)},children:"Register"}),Object(y.jsx)(k,{show:l,handleClose:function(){return b(!1)}})]})},D=function(e){var t=e.text;return Object(y.jsx)(l.a,{href:"/",children:Object(y.jsx)(v.a.Brand,{children:t})})};function _(){var e=Object(r.useContext)(m.a).state.user;return Object(y.jsx)(v.a,{bg:"light",expand:"lg",children:Object(y.jsxs)(b.a,{children:[Object(y.jsx)(v.a.Brand,{href:"/",children:Object(y.jsx)(D,{text:"My Blog"})}),Object(y.jsx)(v.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(y.jsxs)(v.a.Collapse,{id:"basic-navbar-nav",children:[Object(y.jsxs)(g.a,{className:"me-auto",children:[Object(y.jsx)(g.a.Link,{children:Object(y.jsx)(l.a,{href:"/users",children:"Users"})}),e.username&&Object(y.jsx)(g.a.Link,{children:Object(y.jsx)(l.a,{href:"/todo/create",children:"Create New Todo"})})]}),Object(y.jsx)(c.a.Suspense,{fallback:"Loading...",children:Object(y.jsx)(S,{})})]})]})})}var F=a(106),R=a(111);var G=function(e){var t=e.id,a=e.title,c=e.description,n=e.dateCreated,s=e.complete,i=e.dateCompleted,d=e.author,u=e.short,b=void 0!==u&&u,O=Object(r.useContext)(m.a),h=O.state,x=O.dispatch,f=h.user,p=Object(r.useState)(!1),v=Object(j.a)(p,2),g=v[0],w=v[1],T=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}),E=Object(o.b)((function(e){return{url:"/todos",method:"delete",data:{id:e,author:d},headers:{Authorization:"".concat(f.access_token)}}})),L=Object(j.a)(E,2),k=L[0],S=L[1],D=Object(o.b)((function(e){var a=e.complete,r=e.dateCompleted;return{url:"/todos",method:"patch",data:{id:t,complete:a,dateCompleted:r,author:d},headers:{Authorization:"".concat(f.access_token)}}})),_=Object(j.a)(D,2),F=_[0],G=_[1];Object(r.useEffect)((function(){k&&(k.data||k.error)&&!1===k.isLoading&&(k.error?w(!0):(w(!1),x({type:"DELETE_TODO",id:k.data.id})))}),[k]),Object(r.useEffect)((function(){F&&(F.data||F.error)&&!1===F.isLoading&&(F.error?w(!0):(w(!1),x({type:"TOGGLE_TODO",complete:F.data.complete,dateCompleted:F.data.dateCompleted,id:t})))}),[F]);var U=c;return b&&c.length>30&&(U="".concat(c.substring(0,30)," ...")),Object(y.jsx)(R.a,{children:Object(y.jsxs)(R.a.Body,{children:[Object(y.jsx)(R.a.Title,{children:Object(y.jsx)(l.a,{href:"/todo/".concat(t),children:a})}),Object(y.jsx)(R.a.Subtitle,{children:Object(y.jsxs)("i",{children:["Written by ",Object(y.jsx)("b",{children:f.username})]})}),Object(y.jsx)(R.a.Text,{children:U}),Object(y.jsx)("input",{type:"checkbox",checked:s,onChange:function(e){var t=null;t=e.target.checked?Date.now():null,G({complete:e.target.checked,dateCompleted:t})}}),Object(y.jsx)(C.a,{variant:"link",onClick:function(){S(t)},children:"Delete Post"}),Object(y.jsxs)(R.a.Text,{children:["Created on: ",T.format(n)]}),i&&Object(y.jsxs)("i",{children:["Completed on: ",T.format(i)]}),b&&Object(y.jsx)(l.a,{href:"/todo/".concat(t),children:"View full post"}),g&&Object(y.jsx)(R.a.Text,{style:{color:"red"},children:"Unauthorized, Please Login..."})]})})};var U=function(){var e=Object(r.useContext)(m.a).state.todos;return Object(y.jsx)("div",{children:e.map((function(e){return Object(y.jsx)(G,Object(L.a)(Object(L.a)({},e),{},{short:true}),e.id)}))})};function B(){var e=Object(r.useContext)(m.a),t=e.state,a=e.dispatch,c=t.user,n=Object(o.b)((function(){return{url:"/users/".concat(c.id),method:"get",headers:{Authorization:"".concat(c.access_token)}}})),s=Object(j.a)(n,2),i=s[0],d=s[1];Object(r.useEffect)((function(){c.id&&d()}),[c.access_token]),Object(r.useEffect)((function(){i&&i.data&&a({type:"FETCH_TODOS",todos:i.data.todos})}),[i]);var u=i.isLoading;return Object(y.jsxs)(y.Fragment,{children:[u&&Object(y.jsx)(F.a,{animation:"border",role:"status",children:Object(y.jsx)("span",{className:"visually-hidden",children:"Todos Loading..."})}),Object(y.jsx)(U,{})]})}var H=function(){var e=Object(r.useContext)(m.a),t=e.state,a=e.dispatch,c=t.user,n=Object(r.useState)(""),s=Object(j.a)(n,2),i=s[0],d=s[1],u=Object(r.useState)(""),b=Object(j.a)(u,2),O=b[0],h=b[1],x=Object(l.d)(),f=Object(o.b)((function(e){var t=e.title,a=e.description,r=e.dateCreated,n=e.complete,s=e.dateCompleted;return{url:"/todos",method:"post",headers:{Authorization:"".concat(c.access_token)},data:{title:t,description:a,dateCreated:r,complete:n,dateCompleted:s,author:c.id}}})),p=Object(j.a)(f,2),v=p[0],g=p[1];return Object(r.useEffect)((function(){if(v&&v.data&&!1===v.isLoading){var e={id:v.data.id,title:v.data.title,description:v.data.description,dateCreated:v.data.dateCreated,complete:v.data.complete,dateCompleted:v.data.dateCompleted,author:v.data.author};a({type:"CREATE_TODO",newTodo:e}),x.navigate("/todo/".concat(v.data.id))}}),[v]),Object(y.jsxs)("form",{onSubmit:function(e){e.preventDefault(),g({title:i,description:O,dateCreated:Date.now(),complete:!1,dateCompleted:null}),d(""),h("")},children:[Object(y.jsxs)("div",{children:[Object(y.jsx)("label",{htmlFor:"create-title",children:"Title:"}),Object(y.jsx)("input",{type:"text",id:"create-title",value:i,onChange:function(e){d(e.target.value)},name:"create-title"})]}),Object(y.jsx)("br",{}),Object(y.jsx)("textarea",{value:O,onChange:function(e){h(e.target.value)},placeholder:"Description"}),Object(y.jsx)("br",{}),Object(y.jsx)("input",{type:"submit",value:"Create",disabled:0===i.length})]})};function I(e){var t=e.id,a=Object(o.b)((function(){return{url:"/todos/".concat(t),method:"get"}})),c=Object(j.a)(a,2),n=c[0],s=c[1];return Object(r.useEffect)(s,[t]),Object(y.jsxs)("div",{children:[Object(y.jsx)("div",{children:Object(y.jsx)(l.a,{href:"/",children:"Go back"})}),n&&n.data?Object(y.jsx)(G,Object(L.a)({},n.data)):"Loading..."]})}var P=function(e){var t=e.id,a=e.username;return Object(y.jsx)(R.a,{children:Object(y.jsx)(R.a.Body,{children:Object(y.jsx)(R.a.Title,{children:Object(y.jsx)(l.a,{href:"/users/".concat(t),children:a})})})})};var N=function(){var e=Object(r.useContext)(m.a).state.users;return Object(y.jsxs)("div",{children:[Object(y.jsx)("h3",{children:"User List"}),e.map((function(e){return Object(y.jsx)(P,Object(L.a)({},e),e.id)}))]})};function z(){var e=Object(r.useContext)(m.a).dispatch,t=Object(o.b)((function(){return{url:"/users",method:"get"}})),a=Object(j.a)(t,2),c=a[0],n=a[1];Object(r.useEffect)(n,[]),Object(r.useEffect)((function(){c&&c.data&&e({type:"FETCH_USERS",users:c.data.users})}),[c]);var s=c.isLoading;return Object(y.jsxs)(y.Fragment,{children:[s&&Object(y.jsx)(F.a,{animation:"border",role:"status",children:Object(y.jsx)("span",{className:"visually-hidden",children:"Users Loading..."})}),Object(y.jsx)(N,{})]})}function A(e){var t=e.id,a=Object(r.useContext)(m.a).dispatch,c=Object(o.b)((function(){return{url:"/users/".concat(t),method:"get"}})),n=Object(j.a)(c,2),s=n[0],i=n[1];Object(r.useEffect)(i,[]),Object(r.useEffect)((function(){s&&!1===s.isLoading&&s.data&&a({type:"FETCH_TODOS",todos:s.data.todos})}),[s]);var d=s.isLoading;return Object(y.jsxs)("div",{children:[Object(y.jsx)("hr",{}),Object(y.jsxs)("div",{children:[Object(y.jsx)(l.a,{href:"/users",children:"Go back"}),d&&"Todos loading..."," ",Object(y.jsx)(U,{})]})]})}var J=function(){var e=Object(r.useReducer)(p,{user:{},todos:[],users:[]}),t=Object(j.a)(e,2),a=t[0],c=t[1],n=a.user,s=Object(u.f)({"/":Object(u.g)({view:Object(y.jsx)(B,{})}),"/users":Object(u.g)({view:Object(y.jsx)(z,{})}),"/users/:userId":Object(u.g)((function(e){return{view:Object(y.jsx)(A,{id:e.params.userId})}})),"/todo/create":Object(u.g)({view:Object(y.jsx)(H,{})}),"/todo/:id":Object(u.g)((function(e){return{view:Object(y.jsx)(I,{id:e.params.id})}}))});return Object(r.useEffect)((function(){n.username?document.title="".concat(n.username,"\u2019s To-Do"):document.title="To-Do"}),[n]),Object(y.jsx)("div",{children:Object(y.jsx)(m.a.Provider,{value:{state:a,dispatch:c},children:Object(y.jsx)(l.b,{routes:s,children:Object(y.jsxs)(b.a,{children:[Object(y.jsx)(_,{}),Object(y.jsx)("hr",{}),Object(y.jsx)(l.c,{})]})})})})},M=d.a.create({baseURL:"/"});s.a.render(Object(y.jsx)(c.a.StrictMode,{children:Object(y.jsx)(o.a,{value:M,children:Object(y.jsx)(J,{})})}),document.getElementById("root"))},60:function(e,t,a){},8:function(e,t,a){"use strict";var r=a(0),c=a.n(r).a.createContext({state:{},dispatch:function(){}});t.a=c}},[[101,1,2]]]);
//# sourceMappingURL=main.9a31733a.chunk.js.map